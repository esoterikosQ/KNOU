---
title: "Untitled"
author: "SeungGyu Bak"
date: "2022-09-23"
output: word_document
---

```{r setup, include=FALSE}
library(datarium)
```

## 다음 문항에 답하시오. 풀이에 사용한 R 코드와 출력결과를 답안에 포함하시오.

### 1.	R datarium package에 내장된 데이터 heartattack에는 임상시험 참가자 72명의 성별(gender), 복용한 약물(drug), 혈중 콜레스테롤 농도(cholesterol)가 저장되어있다. 

```{r} 
# import data
data(heartattack)
attach(heartattack)
tail(heartattack)
```

### A.	cholesterol의 히스토그램을 그리시오. (2점) 


````{r 1-A}
hist(cholesterol, main = 'Histogram of Cholesterol', xlab = 'Cholesterol Concentration')
```
  
참가자들의 혈중 콜레스테롤 농도를 히스토그램으로 나타내면 위와 같다. 최빈값은 4.5~5.0 사이에 위치해있고 오른쪽으로 꼬리가 길게 늘어져있는 것을 확인할 수 있다.

### B.	성별로 cholesterol의 상자그림을 나란히 그리시오. (2점)

```{r 1-B}
boxplot(cholesterol~gender, main = 'Boxplot of Cholesterol by Gender')
```
  
성별에 따른 콜레스테롤 농도 상자그림을 그리면 위와 같다. 분위수, 중앙값 등 각 집단의 통계적 특성을 보여주는 지표를 중심으로 남성 집단의 콜로레스테롤 농도가 높은 것으로 나타난다.


### C.	남녀 간의 cholesterol 평균에 차이가 있는지 독립표본 t-검정으로 검정하시오. (3점)

```{R 1-c}
t.test(cholesterol~gender)
```
  
주어진 표본값을 기준으로 남년 두 집단의 콜레스테롤 농도 차이가 유의미한지를 확인하기 위해 t검정을 한 결과는 위와 같다. t검정은 이분산을 가정한 Welch's T-test를 실시했고, 귀무가설은  $H_0 : \mu_{male} = \mu_{female}$이다. 검정결과 t통계량은 2.4402로 계산되었고 자유도 67.309에서 t값이 해당 통계량보다 극단적인 값을 가질 확률인 p-값은 0.01732로 나타났다. 이는 유의수준 0.05 수준에서 귀무가설을 기각할 수 있는 수치이다. 남년 두 집단의 콜레스테롤 농도 차이값의 95%의 신뢰구간은 (0.0519, 0.501)로 두 집단의 콜레스테롤 농도 차이는 0이 아니라는 추론이 가능하다.  
따라서 남녀 간의 콜레스테롤 농도 평균에는 차이가 있다고 결론내릴 수 있다.


### D.	복용한 약물에 따라 cholesterol 평균에 차이가 있는지 One-way ANOVA로 검정하시오. (3점)

```{r 1-D}
result <- aov(cholesterol~drug)
summary(result)
```

복용한 약물을 기준으로 콜레스테롤 농도에 차이가 있는지 확인하기 위해 일원분산분석을 실시한 결과는 위와 같다. 귀무가설은 $H_0 : \mu_A = \mu_B = \mu_C$이다. 복용한 약물을 기준으로 세 집단을 구분하여 집단내 분산과 집단간 분산값의 차이를 계산하여 도출한 F통계량은 2.63이고 df = (그룹의 수 - 1) = 2이다. df=2인 F분포에서 2.63보다 극단적인 통계값을 가질 확률은 0.0793이다. 이는 유의수준 0.05 수준에서 귀무가설을 기각할 수 없는 수치이다.  
따라서, 복용한 약물로 인한 콜레스테롤 농도 차이는 없다고 결론내릴 수 있다.


### E.	복용한 약물에 따라 cholesterol 평균에 차이가 있는지 Kruskal-Wallis test로 검정하시오. (3점)

```{r 1-E}
kruskal.test(cholesterol~drug)
```
  
Kruskal-Wallis test는 모집단의 분포에 대한 가정없이 두 모집단의 분포의 위치가 동일한지를 검정하는 방법으로, 주어진 사례에서 귀무가설은 $H_0 : A, B, C 약물복용군의 분포가 동일하다$이다. 검정결과 통계량은 2.7976으로 df=2이다. $\chi^2$ 분포에서 해당 통계량보다 극단적인 값을 가질 확률은 0.2469로, 유의수준 0.05에서 귀무가설을 기각하지 못한다.  
따라서, 복용한 약물로 인한 콜레스테롤 농도 차이는 없다고 결론내릴 수 있다.


## 2.	Beta 분포를 따르는 표본을 뽑았을 때 표본평균의 분포가 정규분포에 가까워진다는 것을 관찰하기 위해 아래의 단계를 수행하시오.

### A.	Beta(1, 4) 분포를 따르는 샘플사이즈 100인 랜덤 표본을 1번 뽑아서 히스토그램을 그리시오. (힌트: Beta(a, b) 분포를 따르는 난수 n개를 생성하는 R 코드는 rbeta(n, a, b) 이다.) (3점)

``` {r 2-A}
dt <- rbeta(100, 1, 4)
hist(dt, breaks = seq(0, 1, 0.02), main = 'Histogram of Beta Dist. with Sample Size 100', xlab = 'Value')
```
  
$\beta(1,4)$ 분포를 따르는 모집단에서 100개의 랜덤 표본을 추출하여 그린 히스토그램은 위와 같다. 기대값인 0.2를 중심으로 분산은 0.027인 분포를 가지며 오른쪽으로 꼬리가 긴 형태를 가지는 것을 알 수 있다. 다만, 표본의 수가 크지 않아 기대값의 위치가 제대로 나타나지 않고 있다. 

  
### B.	2-A의 힌트와 2강 강의록 10쪽을 참고하여, Beta(1, 4) 분포를 따르는 샘플사이즈 100인 랜덤 표본을 10,000번 뽑아서 각 표본의 평균을 계산하시오. 그 10,000개의 표본평균의 분포를 히스토그램으로 나타내시오. (4점)

```{r 2-B}
result <- 0
for (i in 1:10000) result[i] <- mean(rbeta(100, 1, 4))
hist(result, main = 'Histogram of Mean of 10,000 Random Samples with Beta Dist.', xlab = 'Value')
```
  
$\beta(1, 4)$ 분포의 모수에서 추출한 100개 값의 표본평균을 추출하는 작업을 10,000번 반복하여 표본평균의 분포를 히스토그램으로 나타낸 결과는 위와 같다. 모분포의 이론상 평균값인 0.2를 중심으로 양쪽으로 대칭을 이루는 종모양의 분포를 보여주고 있다. 이는 중심극한정리를 보여주는 결과로, 중심극한정리에 따르면 위 표본평균의 분포는 N(0.2, 0.0000027)를 가진다고 추정할 수 있다.